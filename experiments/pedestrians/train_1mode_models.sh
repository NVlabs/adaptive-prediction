#!/bin/bash

# Ours
torchrun --nproc_per_node=1 --master_port=29500 ../../train_unified.py --eval_every=1 --vis_every=1 --batch_size=256 --eval_batch_size=256 --preprocess_workers=16 --log_dir=kf_models --log_tag=eth_1mode_adaptive_tpp --train_epochs=4 --conf=../../config/nuScenes_state_delta.json --trajdata_cache_dir=~/.unified_data_cache --data_loc_dict=\{\"eupeds_eth\":\ \"~/datasets/eth_ucy_peds\"\} --train_data=eupeds_eth-train --eval_data=eupeds_eth-val --history_sec=3.2 --prediction_sec=4.8 --K=1 --adaptive=True --augment_input_noise=0.80 --grad_clip=42 --learning_rate=0.0018 --sigma_eps_init=0.105

# The hyperparamter values for hotel might be a bit inexact, see kf_models/hotel_1mode_adaptive_tpp-10_Sep_2022_16_40_15/config.json for full-fidelity values.
torchrun --nproc_per_node=1 --master_port=29501 ../../train_unified.py --eval_every=1 --vis_every=1 --batch_size=256 --eval_batch_size=256 --preprocess_workers=16 --log_dir=kf_models --log_tag=hotel_1mode_adaptive_tpp --train_epochs=5 --conf=../../config/nuScenes_state_delta.json --trajdata_cache_dir=~/.unified_data_cache --data_loc_dict=\{\"eupeds_hotel\":\ \"~/datasets/eth_ucy_peds\"\} --train_data=eupeds_hotel-train --eval_data=eupeds_hotel-val --history_sec=3.2 --prediction_sec=4.8 --K=1 --adaptive=True --augment_input_noise=0.44 --grad_clip=54.08 --learning_rate=0.009 --sigma_eps_init=0.065

torchrun --nproc_per_node=1 --master_port=29502 ../../train_unified.py --eval_every=1 --vis_every=1 --batch_size=256 --eval_batch_size=256 --preprocess_workers=16 --log_dir=kf_models --log_tag=zara1_1mode_adaptive_tpp --train_epochs=5 --conf=../../config/nuScenes_state_delta.json --trajdata_cache_dir=~/.unified_data_cache --data_loc_dict=\{\"eupeds_zara1\":\ \"~/datasets/eth_ucy_peds\"\} --train_data=eupeds_zara1-train --eval_data=eupeds_zara1-val --history_sec=3.2 --prediction_sec=4.8 --K=1 --adaptive=True --augment_input_noise=0.874 --grad_clip=1.638 --learning_rate=0.0092 --sigma_eps_init=0.06986

torchrun --nproc_per_node=1 --master_port=29503 ../../train_unified.py --eval_every=1 --vis_every=1 --batch_size=256 --eval_batch_size=256 --preprocess_workers=16 --log_dir=kf_models --log_tag=zara2_1mode_adaptive_tpp --train_epochs=4 --conf=../../config/nuScenes_state_delta.json --trajdata_cache_dir=~/.unified_data_cache --data_loc_dict=\{\"eupeds_zara2\":\ \"~/datasets/eth_ucy_peds\"\} --train_data=eupeds_zara2-train --eval_data=eupeds_zara2-val --history_sec=3.2 --prediction_sec=4.8 --K=1 --adaptive=True --augment_input_noise=0.15 --grad_clip=2.85 --learning_rate=0.005 --sigma_eps_init=0.0004

# The hyperparamter values for zara2 might be a bit inexact, see kf_models/zara2_1mode_adaptive_tpp-10_Sep_2022_15_27_50/config.json for full-fidelity values.
torchrun --nproc_per_node=1 --master_port=29504 ../../train_unified.py --eval_every=1 --vis_every=1 --batch_size=256 --eval_batch_size=256 --preprocess_workers=16 --log_dir=kf_models --log_tag=univ_1mode_adaptive_tpp --train_epochs=1 --conf=../../config/nuScenes_state_delta.json --trajdata_cache_dir=~/.unified_data_cache --data_loc_dict=\{\"eupeds_univ\":\ \"~/datasets/eth_ucy_peds\"\} --train_data=eupeds_univ-train --eval_data=eupeds_univ-val --history_sec=3.2 --prediction_sec=4.8 --K=1 --adaptive=True --augment_input_noise=0.10 --grad_clip=96.45 --learning_rate=0.00084 --sigma_eps_init=0.0076

# K0
torchrun --nproc_per_node=1 --master_port=29500 ../../train_unified.py --eval_every=1 --vis_every=1 --batch_size=256 --eval_batch_size=256 --preprocess_workers=16 --log_dir=kf_models --log_tag=eth_1mode_k0_tpp --train_epochs=5 --conf=../../config/nuScenes_state_delta.json --trajdata_cache_dir=~/.unified_data_cache --data_loc_dict=\{\"eupeds_eth\":\ \"~/datasets/eth_ucy_peds\"\} --train_data=eupeds_eth-train --eval_data=eupeds_eth-val --history_sec=3.2 --prediction_sec=4.8 --K=1 --adaptive=True --augment_input_noise=0.90 --grad_clip=45.29 --learning_rate=0.0024 --sigma_eps_init=0.47 --only_k0=True

torchrun --nproc_per_node=1 --master_port=29501 ../../train_unified.py --eval_every=1 --vis_every=1 --batch_size=256 --eval_batch_size=256 --preprocess_workers=16 --log_dir=kf_models --log_tag=hotel_1mode_k0_tpp --train_epochs=5 --conf=../../config/nuScenes_state_delta.json --trajdata_cache_dir=~/.unified_data_cache --data_loc_dict=\{\"eupeds_hotel\":\ \"~/datasets/eth_ucy_peds\"\} --train_data=eupeds_hotel-train --eval_data=eupeds_hotel-val --history_sec=3.2 --prediction_sec=4.8 --K=1 --adaptive=True --augment_input_noise=0.56 --grad_clip=0.23 --learning_rate=0.002 --sigma_eps_init=0.05 --only_k0=True

torchrun --nproc_per_node=1 --master_port=29502 ../../train_unified.py --eval_every=1 --vis_every=1 --batch_size=256 --eval_batch_size=256 --preprocess_workers=16 --log_dir=kf_models --log_tag=zara1_1mode_k0_tpp --train_epochs=5 --conf=../../config/nuScenes_state_delta.json --trajdata_cache_dir=~/.unified_data_cache --data_loc_dict=\{\"eupeds_zara1\":\ \"~/datasets/eth_ucy_peds\"\} --train_data=eupeds_zara1-train --eval_data=eupeds_zara1-val --history_sec=3.2 --prediction_sec=4.8 --K=1 --adaptive=True --augment_input_noise=0.80 --grad_clip=0.17 --learning_rate=0.001 --sigma_eps_init=0.00025 --only_k0=True

torchrun --nproc_per_node=1 --master_port=29503 ../../train_unified.py --eval_every=1 --vis_every=1 --batch_size=256 --eval_batch_size=256 --preprocess_workers=16 --log_dir=kf_models --log_tag=zara2_1mode_k0_tpp --train_epochs=5 --conf=../../config/nuScenes_state_delta.json --trajdata_cache_dir=~/.unified_data_cache --data_loc_dict=\{\"eupeds_zara2\":\ \"~/datasets/eth_ucy_peds\"\} --train_data=eupeds_zara2-train --eval_data=eupeds_zara2-val --history_sec=3.2 --prediction_sec=4.8 --K=1 --adaptive=True --augment_input_noise=0.15 --grad_clip=2.85 --learning_rate=0.0087 --sigma_eps_init=0.0004 --only_k0=True

torchrun --nproc_per_node=1 --master_port=29504 ../../train_unified.py --eval_every=1 --vis_every=1 --batch_size=256 --eval_batch_size=256 --preprocess_workers=16 --log_dir=kf_models --log_tag=univ_1mode_k0_tpp --train_epochs=1 --conf=../../config/nuScenes_state_delta.json --trajdata_cache_dir=~/.unified_data_cache --data_loc_dict=\{\"eupeds_univ\":\ \"~/datasets/eth_ucy_peds\"\} --train_data=eupeds_univ-train --eval_data=eupeds_univ-val --history_sec=3.2 --prediction_sec=4.8 --K=1 --adaptive=True --augment_input_noise=0.66 --grad_clip=0.15 --learning_rate=0.0032 --sigma_eps_init=0.15 --only_k0=True

# Base
torchrun --nproc_per_node=1 --master_port=29502 ../../train_unified.py --eval_every=1 --vis_every=1 --batch_size=256 --eval_batch_size=256 --preprocess_workers=16 --log_dir=kf_models --log_tag=eth_1mode_base_tpp --train_epochs=5 --augment_input_noise=0.35 --conf=../../config/nuScenes_state_delta.json --trajdata_cache_dir=~/.unified_data_cache --data_loc_dict=\{\"eupeds_eth\":\ \"~/datasets/eth_ucy_peds\"\} --train_data=eupeds_eth-train --eval_data=eupeds_eth-val --history_sec=3.2 --prediction_sec=4.8 --K=1 --augment_input_noise=0.34 --grad_clip=0.10 --learning_rate=0.003

torchrun --nproc_per_node=1 --master_port=29502 ../../train_unified.py --eval_every=1 --vis_every=1 --batch_size=256 --eval_batch_size=256 --preprocess_workers=16 --log_dir=kf_models --log_tag=hotel_1mode_base_tpp --train_epochs=5 --augment_input_noise=0.35 --conf=../../config/nuScenes_state_delta.json --trajdata_cache_dir=~/.unified_data_cache --data_loc_dict=\{\"eupeds_hotel\":\ \"~/datasets/eth_ucy_peds\"\} --train_data=eupeds_hotel-train --eval_data=eupeds_hotel-val --history_sec=3.2 --prediction_sec=4.8 --K=1 --grad_clip=0.11 --learning_rate=0.005

torchrun --nproc_per_node=1 --master_port=29502 ../../train_unified.py --eval_every=1 --vis_every=1 --batch_size=256 --eval_batch_size=256 --preprocess_workers=16 --log_dir=kf_models --log_tag=zara1_1mode_base_tpp --train_epochs=5 --augment_input_noise=0.35 --conf=../../config/nuScenes_state_delta.json --trajdata_cache_dir=~/.unified_data_cache --data_loc_dict=\{\"eupeds_zara1\":\ \"~/datasets/eth_ucy_peds\"\} --train_data=eupeds_zara1-train --eval_data=eupeds_zara1-val --history_sec=3.2 --prediction_sec=4.8 --K=1

torchrun --nproc_per_node=1 --master_port=29502 ../../train_unified.py --eval_every=1 --vis_every=1 --batch_size=256 --eval_batch_size=256 --preprocess_workers=16 --log_dir=kf_models --log_tag=zara2_1mode_base_tpp --train_epochs=5 --augment_input_noise=0.35 --conf=../../config/nuScenes_state_delta.json --trajdata_cache_dir=~/.unified_data_cache --data_loc_dict=\{\"eupeds_zara2\":\ \"~/datasets/eth_ucy_peds\"\} --train_data=eupeds_zara2-train --eval_data=eupeds_zara2-val --history_sec=3.2 --prediction_sec=4.8 --K=1

torchrun --nproc_per_node=1 --master_port=29502 ../../train_unified.py --eval_every=1 --vis_every=1 --batch_size=256 --eval_batch_size=256 --preprocess_workers=16 --log_dir=kf_models --log_tag=univ_1mode_base_tpp --train_epochs=1 --augment_input_noise=0.35 --conf=../../config/nuScenes_state_delta.json --trajdata_cache_dir=~/.unified_data_cache --data_loc_dict=\{\"eupeds_univ\":\ \"~/datasets/eth_ucy_peds\"\} --train_data=eupeds_univ-train --eval_data=eupeds_univ-val --history_sec=3.2 --prediction_sec=4.8 --K=1

# Oracle is just Base on the target split